<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CLT: Zulu vs Marquinho - Edi√ß√£o Cervejinha</title>
    <a href="/abrir-jogo"><button>Clique aqui para Jogar</button></a>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: 'Arial Black', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: #111;
            overflow: hidden;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hud {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            z-index: 10;
            pointer-events: none;
            gap: 5px;
        }

        .stat-label {
            background: rgba(0, 0, 0, 0.7);
            color: #f1c40f;
            padding: 5px 10px;
            font-size: 14px;
            border: 2px solid #f1c40f;
            border-radius: 5px;
            text-align: center;
            min-width: 80px;
        }

        .ammo-label {
            border-color: #2ecc71;
            color: #2ecc71;
            font-weight: bold;
        }

        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        #cobranca-screen { display: none; }

        .marquinho-img {
            width: 250px;
            height: 250px;
            max-width: 60vw;
            max-height: 60vw;
            border: 6px solid #ff0000;
            border-radius: 15px;
            object-fit: cover;
            margin-bottom: 10px;
        }

        .taunt-text {
            color: #fff;
            font-size: 24px;
            margin: 10px;
            background: #ff0000;
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 5px;
        }

        button {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 10px;
            box-shadow: 0 6px #27ae60;
        }

        .btn-retry { background: #e74c3c; box-shadow: 0 6px #c0392b; }
    </style>
</head>
<body>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
        
        <div class="hud">
            <div class="stat-label">R$ <span id="score">0</span></div>
            <div class="stat-label ammo-label">üç∫ ESTOQUE: <span id="ammo-count">0</span></div>
            <div class="stat-label">VIL√ïES: <span id="passed-count">0</span></div>
            <div class="stat-label" style="border-color: #e74c3c;">RITMO: <span id="speed-display">0.7</span>x</div>
        </div>

        <!-- Tela Inicial -->
        <div id="start-screen" class="overlay">
            <h1 style="color: #ff0000; font-size: 32px; margin: 0;">ZULU: BUSCA PELA CERVEJA</h1>
            <p style="margin: 10px 0 20px; color: #ccc;">SALTO FLUTUANTE ATIVADO!<br>ESQUERDA: PULAR | DIREITA: TACAR</p>
            <button onclick="startGame()">COME√áAR MISS√ÉO</button>
        </div>

        <!-- Tela de Derrota -->
        <div id="cobranca-screen" class="overlay">
            <img src="image_766aa6.jpg" class="marquinho-img" alt="Marquinho">
            <div class="taunt-text">"N√ÉO VAI ME PAGAR N√ÉO NEG√ÉO?"</div>
            <p id="final-score" style="color: #f1c40f; font-size: 20px; margin-bottom: 20px;">D√≠vida: R$ 0</p>
            <button class="btn-retry" onclick="startGame()">TENTAR DE NOVO</button>
        </div>
    </div>

<script>
    
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const ammoEl = document.getElementById('ammo-count');
    const speedEl = document.getElementById('speed-display');
    const passedEl = document.getElementById('passed-count');
    const cobrancaScreen = document.getElementById('cobranca-screen');
    const startScreen = document.getElementById('start-screen');
    const finalScoreEl = document.getElementById('final-score');

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // --- CARREGAMENTO DE IMAGENS ---
    const imgZulu = new Image(); imgZulu.src = 'zulu.png';
    const imgAgiota = new Image(); imgAgiota.src = 'agiota.png';
    const imgFundo = new Image(); imgFundo.src = 'fundo.jpg'; 

    let gameActive = false;
    let score = 0;
    let frames = 0;
    let entities = [];
    let projectiles = [];
    let powerups = []; 
    let speedMultiplier = 0.7; 
    let obstaclesPassed = 0;
    let beerAmmo = 0; 

    const zulu = {
        x: 50, 
        y: 0, 
        w: 90, 
        h: 120,
        dy: 0, 
        gravity: 0.6, // Gravidade reduzida para cair devagar (era 1.2)
        jumpPower: -18, // For√ßa de pulo ajustada para a nova gravidade
        grounded: false,
        update() {
            const groundY = canvas.height - this.h - 50;
            this.dy += this.gravity;
            this.y += this.dy;

            if (this.y >= groundY) {
                this.y = groundY;
                this.dy = 0;
                this.grounded = true;
            }
        },
        draw() {
            ctx.save();
            ctx.fillStyle = "rgba(0,0,0,0.4)";
            ctx.beginPath();
            ctx.ellipse(this.x + this.w/2, this.y + this.h, 35, 8, 0, 0, Math.PI*2);
            ctx.fill();

            if (imgZulu.complete && imgZulu.naturalHeight !== 0) {
                ctx.drawImage(imgZulu, this.x, this.y, this.w, this.h);
            } else {
                ctx.fillStyle = "#007bff";
                ctx.fillRect(this.x, this.y, this.w, this.h);
            }
            
            ctx.fillStyle = "#fff";
            ctx.font = "bold 10px Arial";
            ctx.textAlign = "center";
            ctx.fillText("ZULU", this.x + this.w/2, this.y - 10);
            ctx.restore();
        },
        jump() { if (this.grounded) { this.dy = this.jumpPower; this.grounded = false; } },
        throwBeer() {
            if (beerAmmo > 0) {
                beerAmmo--;
                ammoEl.innerText = beerAmmo;
                projectiles.push({
                    x: this.x + this.w,
                    y: this.y + this.h / 2,
                    speed: 12
                });
            }
        }
    };

    function spawnAgiota() {
        const agiotaH = 90;
        entities.push({
            x: canvas.width,
            y: canvas.height - agiotaH - 50, 
            w: 65, 
            h: agiotaH, 
            speed: (4.5 + Math.random() * 3) * speedMultiplier
        });
    }

    function spawnBeerPowerup() {
        // Cerveja agora aparece "no meio" (altura entre o ch√£o e o topo do pulo)
        // Facilitando pegar sem cair no agiota
        powerups.push({
            x: canvas.width,
            y: canvas.height - 230 - Math.random() * 40, 
            w: 40,
            h: 40,
            speed: 5 * speedMultiplier
        });
    }

    function checkCollisions() {
        for (let k = powerups.length - 1; k >= 0; k--) {
            let p = powerups[k];
            p.x -= p.speed;

            if (zulu.x < p.x + p.w && zulu.x + zulu.w > p.x && zulu.y < p.y + p.h && zulu.y + zulu.h > p.y) {
                powerups.splice(k, 1);
                beerAmmo += 15;
                ammoEl.innerText = beerAmmo;
                score += 100;
                continue;
            }

            if (p.x < -50) powerups.splice(k, 1);
        }

        for (let j = projectiles.length - 1; j >= 0; j--) {
            let p = projectiles[j];
            p.x += p.speed;

            if (p.x > canvas.width) {
                projectiles.splice(j, 1);
                continue;
            }

            for (let i = entities.length - 1; i >= 0; i--) {
                let en = entities[i];
                if (p.x > en.x && p.x < en.x + en.w && p.y > en.y && p.y < en.y + en.h) {
                    projectiles.splice(j, 1);
                    entities.splice(i, 1);
                    score += 500;
                    incrementPassed();
                    break;
                }
            }
        }

        for (let i = entities.length - 1; i >= 0; i--) {
            let en = entities[i];
            const margin = 15;
            if (zulu.x + zulu.w - margin > en.x && zulu.x + margin < en.x + en.w && zulu.y + zulu.h > en.y + margin) {
                gameActive = false;
                finalScoreEl.innerText = "D√≠vida: R$ " + score;
                cobrancaScreen.style.display = 'flex';
            }
        }
    }

    function incrementPassed() {
        obstaclesPassed++;
        passedEl.innerText = obstaclesPassed;
        if (obstaclesPassed % 10 === 0) {
            speedMultiplier += 0.05;
            speedEl.innerText = speedMultiplier.toFixed(1);
        }
    }

    function update() {
        if (!gameActive) return;
        frames++;

        zulu.update();

        const rate = Math.max(35, Math.floor(110 / speedMultiplier));
        if (frames % rate === 0) spawnAgiota();

        // Frequ√™ncia de cervejas ajustada para ser mais estrat√©gica
        if (frames % 200 === 0) spawnBeerPowerup();

        for (let i = entities.length - 1; i >= 0; i--) {
            let en = entities[i];
            en.x -= en.speed;
            if (en.x + en.w < 0) {
                entities.splice(i, 1);
                incrementPassed();
            }
        }

        checkCollisions();
        scoreEl.innerText = score;
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (imgFundo.complete && imgFundo.naturalHeight !== 0) {
            ctx.drawImage(imgFundo, 0, 0, canvas.width, canvas.height);
        } else {
            ctx.fillStyle = "#222";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        zulu.draw();

        projectiles.forEach(p => {
            ctx.font = "25px Arial";
            ctx.fillText("üç∫", p.x, p.y + 10);
        });

        powerups.forEach(p => {
            ctx.font = "40px Arial";
            ctx.fillText("üç∫", p.x, p.y + 30);
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#f1c40f";
        });
        ctx.shadowBlur = 0;

        entities.forEach(en => {
            if (imgAgiota.complete && imgAgiota.naturalHeight !== 0) {
                ctx.drawImage(imgAgiota, en.x, en.y, en.w, en.h);
            } else {
                ctx.fillStyle = "#ff4444";
                ctx.fillRect(en.x, en.y, en.w, en.h);
            }
        });
    }

    function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
    }

    function startGame() {
        score = 0;
        frames = 0;
        entities = [];
        projectiles = [];
        powerups = [];
        obstaclesPassed = 0;
        beerAmmo = 0; 
        speedMultiplier = 0.7; 
        
        passedEl.innerText = "0";
        speedEl.innerText = "0.7";
        ammoEl.innerText = "0";
        scoreEl.innerText = "0";

        gameActive = true;
        cobrancaScreen.style.display = 'none';
        startScreen.style.display = 'none';
    }

    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touchX = e.touches[0].clientX;
        if (touchX < window.innerWidth / 2) {
            zulu.jump();
        } else {
            zulu.throwBeer();
        }
    }, {passive: false});

    window.addEventListener('keydown', (e) => {
        if (e.code === 'Space') zulu.jump();
        if (e.code === 'ArrowRight' || e.code === 'KeyD') zulu.throwBeer();
    });

    gameLoop();
</script>
</body>
</html>